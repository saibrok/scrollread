<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Teleprompter</title>
  <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@300;400;600&display=swap" rel="stylesheet">
  <style>
    :root {
      color-scheme: light dark;
      --bg: #f6f7fb;
      --bg-accent: #e8ebf6;
      --surface: #ffffff;
      --text: #1f2633;
      --muted: #606778;
      --border: #d9deea;
      --accent: #2f5ef5;
      --accent-weak: #e7eeff;
      --shadow: 0 10px 30px rgba(21, 30, 50, 0.12);
    }

    body.theme-dark {
      --bg: #0e1117;
      --bg-accent: #161c28;
      --surface: #141a24;
      --text: #e8edf7;
      --muted: #9aa6bc;
      --border: #283047;
      --accent: #6ea3ff;
      --accent-weak: #1a2640;
      --shadow: 0 10px 30px rgba(0, 0, 0, 0.35);
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: "Rubik", "Segoe UI", Arial, sans-serif;
      background: radial-gradient(circle at top left, var(--bg-accent), var(--bg));
      color: var(--text);
      min-height: 100vh;
      display: flex;
      align-items: stretch;
    }

    .page {
      width: min(1100px, 92vw);
      margin: 48px auto 72px;
      display: flex;
      flex-direction: column;
      gap: 24px;
    }

    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .title {
      font-size: 30px;
      font-weight: 600;
      letter-spacing: 0.2px;
    }

    .subtitle {
      color: var(--muted);
      font-size: 14px;
    }

    .card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 20px;
      padding: 28px;
      box-shadow: var(--shadow);
      display: grid;
      grid-template-columns: 1.4fr 0.9fr;
      gap: 24px;
    }

    .editor {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .label {
      font-size: 13px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: var(--muted);
    }

    textarea {
      width: 100%;
      min-height: 360px;
      border-radius: 16px;
      border: 1px solid var(--border);
      padding: 16px 18px;
      font-size: 16px;
      line-height: 1.6;
      color: var(--text);
      background: transparent;
      resize: vertical;
    }

    textarea:focus,
    select:focus,
    input[type="range"]:focus {
      outline: 2px solid var(--accent);
      outline-offset: 2px;
    }

    .controls {
      display: flex;
      flex-direction: column;
      gap: 18px;
    }

    .control {
      background: var(--bg-accent);
      border-radius: 16px;
      padding: 16px;
      border: 1px solid var(--border);
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .value {
      font-size: 28px;
      font-weight: 600;
    }

    .checkbox {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      font-size: 14px;
      color: var(--muted);
    }

    .range-row {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 14px;
      color: var(--muted);
    }

    .meta {
      font-size: 14px;
      color: var(--muted);
    }

    select,
    input[type="range"] {
      width: 100%;
    }

    .start {
      margin-top: auto;
      background: var(--accent);
      color: #fff;
      border: none;
      border-radius: 14px;
      padding: 14px 18px;
      font-size: 15px;
      font-weight: 600;
      letter-spacing: 0.06em;
      cursor: pointer;
      transition: transform 0.15s ease, box-shadow 0.15s ease;
      box-shadow: 0 12px 24px rgba(47, 94, 245, 0.3);
    }

    .start:hover {
      transform: translateY(-1px);
    }

    .footer-note {
      font-size: 13px;
      color: var(--muted);
    }

    @media (max-width: 900px) {
      .card {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="page">
    <header>
      <div>
        <div class="title">Teleprompter</div>
        <div class="subtitle">Черновик настроек и текста</div>
      </div>
      <div class="footer-note">Сохраняются только настройки</div>
    </header>

    <section class="card">
      <div class="editor">
        <div class="label">Текст</div>
        <textarea id="inputText" placeholder="Вставьте текст, который будете читать"></textarea>
      </div>

      <div class="controls">
        <div class="control">
          <div class="label">Символы</div>
          <div class="value" id="charCount">0</div>
          <label class="checkbox">
            <input type="checkbox" id="includeSpaces" checked>
            включая пробелы
          </label>
        </div>

        <div class="control">
          <div class="label">Скорость</div>
          <input type="range" id="speed" min="100" max="2000" step="100" value="800">
          <div class="range-row">
            <strong id="speedValue">800</strong>
            знаков/мин
          </div>
          <div class="meta">Оценка времени: <span id="timeRange">0:00–0:00</span></div>
        </div>

        <div class="control">
          <div class="label">Тема интерфейса</div>
          <select id="themeSelect">
            <option value="system">Системная</option>
            <option value="light">Светлая</option>
            <option value="dark">Темная</option>
          </select>
        </div>

        <button class="start" id="startBtn">НАЧАТЬ</button>
      </div>
    </section>
  </div>

  <script>
    const STORAGE_KEY = "teleprompter_settings_v1";
    const state = {
      includeSpaces: true,
      speed: 800,
      theme: "system",
    };

    const inputText = document.getElementById("inputText");
    const includeSpaces = document.getElementById("includeSpaces");
    const speedInput = document.getElementById("speed");
    const speedValue = document.getElementById("speedValue");
    const charCount = document.getElementById("charCount");
    const timeRange = document.getElementById("timeRange");
    const themeSelect = document.getElementById("themeSelect");

    const mediaQuery = window.matchMedia("(prefers-color-scheme: dark)");

    function countChars(text, withSpaces) {
      if (withSpaces) {
        return text.length;
      }
      return text.replace(/\s/g, "").length;
    }

    function formatTime(seconds) {
      const mins = Math.floor(seconds / 60);
      const secs = Math.floor(seconds % 60);
      return `${mins}:${secs.toString().padStart(2, "0")}`;
    }

    function updateCounts() {
      const text = inputText.value;
      const withSpaces = countChars(text, true);
      const withoutSpaces = countChars(text, false);
      charCount.textContent = includeSpaces.checked ? withSpaces : withoutSpaces;

      const speed = Number(speedInput.value);
      const minSeconds = Math.ceil((withoutSpaces / speed) * 60);
      const maxSeconds = Math.ceil((withSpaces / speed) * 60);
      timeRange.textContent = `${formatTime(minSeconds)}–${formatTime(maxSeconds)}`;
      speedValue.textContent = speed;
    }

    function saveSettings() {
      const settings = {
        includeSpaces: includeSpaces.checked,
        speed: Number(speedInput.value),
        theme: themeSelect.value,
      };
      localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));
    }

    function loadSettings() {
      const saved = localStorage.getItem(STORAGE_KEY);
      if (!saved) {
        return;
      }
      try {
        const parsed = JSON.parse(saved);
        if (typeof parsed.includeSpaces === "boolean") {
          state.includeSpaces = parsed.includeSpaces;
        }
        if (typeof parsed.speed === "number") {
          state.speed = parsed.speed;
        }
        if (typeof parsed.theme === "string") {
          state.theme = parsed.theme;
        }
      } catch (error) {
        console.warn("Settings parse error", error);
      }
    }

    function applyTheme() {
      const theme = themeSelect.value;
      document.body.classList.remove("theme-dark");
      if (theme === "dark") {
        document.body.classList.add("theme-dark");
      } else if (theme === "system") {
        if (mediaQuery.matches) {
          document.body.classList.add("theme-dark");
        }
      }
    }

    loadSettings();

    includeSpaces.checked = state.includeSpaces;
    speedInput.value = state.speed;
    themeSelect.value = state.theme;

    updateCounts();
    applyTheme();

    inputText.addEventListener("input", updateCounts);
    includeSpaces.addEventListener("change", () => {
      updateCounts();
      saveSettings();
    });
    speedInput.addEventListener("input", () => {
      updateCounts();
      saveSettings();
    });
    themeSelect.addEventListener("change", () => {
      applyTheme();
      saveSettings();
    });

    mediaQuery.addEventListener("change", () => {
      if (themeSelect.value === "system") {
        applyTheme();
      }
    });
  </script>
</body>
</html>

